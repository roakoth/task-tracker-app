# Creating and Updating a task

It’s time to bring life to the task tracker application and make it interactive. This is the most interesting part. In order to make the form to work, I’ll need to use the `task store` in the `TaskForm` component so that I can add new tasks to it and also reference the tasks that are already created.

I’ll add this code:

```
const $task = useStore(task)
const $tasks = useStore(tasks)

```

In this specific code snippet, `const $task = useStore(task)` the `useStore` is a hook provided by nanostores. It creates a store instance with the name `task` and assigns it to the constant `$task`. The `$` prefix is used to indicate that a variable represents a store in nanostores. I’ll have a store instance ($task) that can hold and manage the state of a specific task within my component. 

I’ll add a functionality to submit my task details by the click of a button, once the task details are submitted and rendered in the app, below the form, there will be an ‘Edit’ button.
When the 'Edit' button is clicked, it will pre-fill the input fields with that specific task details, I’ll access that individual task by its id. Then I can modify the task details which are on the input fields, and when I click the button, it should update the task details of that specific task.

The function I will create to add a task and update a task will look like this:

```

  const createOrUpdateTask = (e) => {
    e.preventDefault();
    if ($task._id !== "") {
      tasks.set(
        $tasks.map((t) => {
          // return the updated value
          if (t._id === $task._id) {
            return $task;
          }
          // return the original value if value has not changed
          else {
            return t;
          }
        })
      );
    } else {
      tasks.set([
        ...$tasks,
        {
          ...$task,
          _id: nanoid(8),
        },
      ]);
    }
  };

```

I’ll provide an explanation of what this function does. First, I’ll be passing the event object (e) as a parameter and when `e.preventDefault()` is called, it will prevent the default form submission behavior which means the page will not be refreshed. 

This function `createOrUpdateTask` will check if a task exists and if it does not exists, it will create a new task to the store. If that task already exists, that is, if there is an existing task id, it will update that specific task with the values that are set in the input fields. When creating a task, the `id` value will be generated by `nanoid` I want it to have 8 characters long, so I'll put 8 as the parameter like this `nanoid(8)`. I can access the current value of task using `$task.get()`, and I can update the value using `$task.set(newValue)`

After pressing the button to submit the task details, I will need to empty the input fields. I will add the code below to my `createOrUpdateTask` function

```

task.set({
      _id: "",
      taskName: "",
      taskDate: "",
      isCompleted: false,
    });

```

The complete code for the function `createOrUpdateTask` will look like this:

```
  const createOrUpdateTask = (e) => {
    e.preventDefault();
    if ($task._id !== "") {
      tasks.set(
        $tasks.map((t) => {
          // return the updated value
          if (t._id === $task._id) {
            return $task;
          }
          // return the original value if value has not changed
          else {
            return t;
          }
        })
      );
    } else {
      tasks.set([
        ...$tasks,
        {
          ...$task,
          _id: nanoid(8),
        },
      ]);
    }
    console.log($tasks);
    task.set({
      _id: "",
      taskName: "",
      taskDate: "",
      isCompleted: false,
    });
  };

```

Then I will add the `createOrUpdateTask` function to the button so that when it is clicked, it will call the function.

```

<button onClick={createOrUpdateTask} type="submit">
Click
</button>

```

Then I’ll create another function called `setTask` that will handle the case where the values are changed on the input fields.

The function will look like this:

```
 const setTask = (e) => {
        task.set({
            ...$task,
            [e.target.name]: e.target.value
        })
    }

```

`task.set()` function changes the value. 
The code above updates the state of a task object stored in a nanostore called task. It takes an event object (e) as a parameter, which is typically an event object generated by a change event from an input field.

the `task.set()` method is called with a new task object. The spread operator (...$task) is used to clone the existing task object stored in the Nanostore, ensuring that a new object is created and the original object is not modified directly.

The new task object is created using computed property names, where `[e.target.name]` dynamically sets the property name of the task object based on the name attribute of the target element that triggered the event. The value of the property is set to `e.target.value`, which is the value of the target element (an input field) that was changed.

This `setTask` function will be added to the input fields on the `onChange` method like this:

```

 <form>
                <div>
                    <div>
                        <label>
                            Task
                        </label>
                        <input name="taskName" onChange={setTask} type="text" placeholder="Add a Task"/>
                    </div>
                    <div>
                        <label>
                            Date
                        </label>
                        <input name="taskDate" onChange={setTask} type="text" placeholder="Set Date" />
                    </div>
                </div>
               
                <button type="submit">
                    Click
                </button>
            </form>

```

Then I’ll add the value of the input fields to reference the exact value in the task store like this `value={$task.taskName}` and `value={$task.taskDate}`

```

<div>
                    <div>
                        <label>
                            Task
                        </label>
                        <input name="taskName" value={$task.taskName} onChange={setTask} type="text" placeholder="Add a Task"/>
                    </div>
                    <div>
                        <label>
                            Date
                        </label>
                        <input name="taskDate" value={$task.taskDate} onChange={setTask} type="text" placeholder="Set Date" />
                    </div>
                </div>

```

Now, the task form is working, but in order to display the tasks that I have just created, I will need to add some functionalities to the `TaskList` component, to enable it to render the tasks that are created, to have an `Edit` button where I can pre-fill the task details on the input fields and then edit the task, to have a `Complete` button where I can mark my tasks as completed and finally to have a `Delete` button where I can remove the task entirely from my list. 

